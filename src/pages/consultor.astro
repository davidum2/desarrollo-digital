---
import FormSection from '../components/FormSection.astro';
import NavigationButtons from '../components/NavigationButtons.astro';
import ProgressBar from '../components/ProgressBar.astro';
import Layout from '../layouts/Layout.astro';
---

<Layout
  title="Consultoria"
  description="Consultoria en desarrollo digital"
  keywords=""
  image=""
  robot="index,follow"
>
  <script>
    let currentSection = 0;
    const sections = 4; // Número total de secciones

    function nextSection() {
      if (currentSection < sections - 1) {
        currentSection++;
      } else {
        // Aquí se puede manejar el envío del formulario
        submitForm();
      }
    }

    function previousSection() {
      if (currentSection > 0) {
        currentSection--;
      }
    }

    async function submitForm() {
      // Lógica para enviar el formulario a la API
      const response = await fetch('https://api.example.com/submit', {
        method: 'POST',
        body: JSON.stringify({
          /* datos del formulario */
        }),
        headers: {
          'Content-Type': 'application/json',
        },
      });

      if (response.ok) {
        window.location.href = '/result'; // Redirigir a la página de resultados
      } else {
        // Manejar error
        console.error('Error al enviar el formulario');
      }
    }
  </script>

  <div class="bg-gray-100 flex justify-center items-center min-h-screen">
    <div class="w-full max-w-lg bg-white rounded-lg shadow-lg p-6">
      <!-- Barra de progreso -->
      <div class="relative mb-6">
        <div class="w-full h-2 bg-gray-200 rounded-full">
          <div
            class="absolute top-0 left-0 h-2 bg-blue-500 rounded-full transition-all duration-300"
            style="width: 25%;"
            id="progress-bar"
          >
          </div>
        </div>
        <div class="flex justify-between text-sm text-gray-500 mt-2">
          <span>Paso 1</span>
          <span>Paso 2</span>
          <span>Paso 3</span>
          <span>Paso 4</span>
        </div>
      </div>

      <!-- Formulario -->
      <form class="relative">
        <!-- Sección 1 -->
        <input type="radio" name="step" id="step1" class="hidden" checked />
        <div class="step-content">
          <label for="name" class="block text-gray-700 font-medium mb-2"
            >Nombre:</label
          >
          <input
            type="text"
            id="name"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none"
            placeholder="Ingresa tu nombre"
          />
          <button
            type="button"
            class="mt-4 w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition"
            onclick="nextStep(2)">Siguiente</button
          >
        </div>

        <!-- Sección 2 -->
        <input type="radio" name="step" id="step2" class="hidden" />
        <div class="step-content hidden">
          <label for="email" class="block text-gray-700 font-medium mb-2"
            >Correo electrónico:</label
          >
          <input
            type="email"
            id="email"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none"
            placeholder="Ingresa tu correo"
          />
          <button
            type="button"
            class="mt-4 w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition"
            onclick="nextStep(3)">Siguiente</button
          >
        </div>

        <!-- Sección 3 -->
        <input type="radio" name="step" id="step3" class="hidden" />
        <div class="step-content hidden">
          <label for="phone" class="block text-gray-700 font-medium mb-2"
            >Teléfono:</label
          >
          <input
            type="tel"
            id="phone"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none"
            placeholder="Ingresa tu teléfono"
          />
          <button
            type="button"
            class="mt-4 w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600 transition"
            onclick="nextStep(4)">Siguiente</button
          >
        </div>

        <!-- Sección 4 -->
        <input type="radio" name="step" id="step4" class="hidden" />
        <div class="step-content hidden">
          <label for="message" class="block text-gray-700 font-medium mb-2"
            >Mensaje:</label
          >
          <textarea
            id="message"
            class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none"
            placeholder="Ingresa tu mensaje"></textarea>
          <button
            type="submit"
            class="mt-4 w-full bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition"
            >Enviar</button
          >
        </div>
      </form>
    </div>

    <script is:inline>
      function nextStep(step) {
        const steps = document.querySelectorAll('input[name="step"]');
        steps[step - 1].checked = true;

        // Actualizar la barra de progreso
        const progressBar = document.getElementById('progress-bar');
        progressBar.style.width = `${(step / steps.length) * 100}%`;

        // Mostrar/ocultar contenido de las secciones
        const sections = document.querySelectorAll('.step-content');
        sections.forEach((section, index) => {
          section.classList.toggle('hidden', index !== step - 1);
        });
      }
    </script>
  </div>
</Layout>
